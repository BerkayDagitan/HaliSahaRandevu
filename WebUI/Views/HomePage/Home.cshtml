@using Microsoft.AspNetCore.Antiforgery
@inject IAntiforgery Antiforgery
@{
    var token = Antiforgery.GetAndStoreTokens(Context).RequestToken;
}
<input type="hidden" id="__RequestVerificationToken" value="@token" />

<header>
    <nav class="navbar">
        <div class="container">
            <a class="navbar-brand" href="#">Halı Saha Randevu Sistemi</a>
            <div class="navbar-menu">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" asp-controller="Appointment" asp-action="ListAppointment">Randevularım</a></li>
                    <li class="nav-item"><a class="nav-link" asp-controller="Appointment" asp-action="GetAppointment">Randevu Al</a></li>
                    <li class="nav-item"><a class="nav-link logout" href="#">Çıkış Yap</a></li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<style>
    :root {
        --primary: #4361ee;
        --primary-light: #e6f0ff;
        --text: #2b2d42;
        --text-light: #8d99ae;
        --white: #ffffff;
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        --transition: all 0.3s ease;
    }

    body {
        background-color: #f8f9fa;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        color: var(--text);
        line-height: 1.6;
        margin: 0;
        padding: 0;
    }

    .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
    }

    /* Navbar */
    .navbar {
        padding: 20px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        background: var(--white);
    }

    .navbar-brand {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary);
        text-decoration: none;
    }

    .navbar-menu {
        display: flex;
        align-items: center;
    }

    .navbar-nav {
        display: flex;
        list-style: none;
        margin: 0;
        padding: 0;
        margin-left: auto;
    }

    .nav-item {
        margin-left: 30px;
    }

    .nav-link {
        color: var(--text);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
        position: relative;
        padding: 5px 0;
    }

        .nav-link:hover {
            color: var(--primary);
        }

        .nav-link.logout {
            color: #e63946;
        }

            .nav-link.logout:hover {
                color: #c1121f;
            }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const logoutBtn = document.querySelector('.logout');

        logoutBtn.addEventListener('click', async function(e) {
            e.preventDefault();

            try {
                const response = await fetch('/HomePage/Logout', {
                    method: 'POST',
                    headers: {
                        'RequestVerificationToken': document.getElementById('__RequestVerificationToken').value
                    },
                    credentials: 'include'
                });

                if(response.ok) {
                    alert('Başarıyla çıkış yapıldı');
                    window.location.href = '@Url.Action("Login", "LoginPage")';
                } else {
                    alert('Çıkış işlemi başarısız oldu: ' + response.statusText);
                }
            } catch(error) {
                console.error('Çıkış hatası:', error);
                alert('Bir hata oluştu, lütfen tekrar deneyin: ' + error.message);
            }
        });
    });
</script>
